context("Testing censoring patterns")

# Define the input parameters first.

CSH <- list(
    list(Cause = "M", Time = "M_Time", Status = "M_Status", vars = NULL),
    list(Cause = "D1", Time = "D1_Time", Status = "D1_Status", vars = NULL),
    list(Cause = "D2", Time = "D2_Time", Status = "D2_Status", vars = NULL),
    list(Cause = "D3", Time = "D3_Time", Status = "D3_Status", vars = NULL)
)

dfnames <-  c("M_Time", "D1_Time", "D2_Time", "D3_Time",
              "M_Status", "D1_Status", "D2_Status", "D3_Status")

# Test Scenario 1.

df <- data.frame(rbind(
    c(1.00, 1.50, 1.75, 2.25, 1, 0, 0, 0),
    c(1.00, 1.50, 1.75, 2.25, 1, 0, 0, 1),
    c(1.00, 1.50, 1.75, 2.25, 1, 0, 1, 0),
    c(1.00, 1.50, 1.75, 2.25, 1, 0, 1, 1),
    c(1.00, 1.50, 1.75, 2.25, 1, 1, 0, 0),
    c(1.00, 1.50, 1.75, 2.25, 1, 1, 0, 1),
    c(1.00, 1.50, 1.75, 2.25, 1, 1, 1, 0),
    c(1.00, 1.50, 1.75, 2.25, 1, 1, 1, 1)
))

dfc <- data.frame(rbind(
    c(1.00, 1.00, 1.00, 1.00, 1, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 1, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 1, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 1, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 1, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 1, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 1, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 1, 0, 0, 0)
))

names(df) <- dfnames
names(dfc) <- dfnames

test_that("Scenario 1 is handled correctly", {
    expect_identical(csh_censor(df, csh = CSH, fuw = 1), dfc)
})

# Test Scenario 2.

df <- data.frame(rbind(
    c(1.00, 1.25, 1.75, 2.25, 0, 0, 0, 1),
    c(1.00, 1.25, 1.75, 2.25, 0, 0, 1, 0),
    c(1.00, 1.25, 1.75, 2.25, 0, 0, 1, 1),
    c(1.00, 1.25, 1.75, 2.25, 0, 1, 0, 0),
    c(1.00, 1.25, 1.75, 2.25, 0, 1, 0, 1),
    c(1.00, 1.25, 1.75, 2.25, 0, 1, 1, 0),
    c(1.00, 1.25, 1.75, 2.25, 0, 1, 1, 1)
))

dfc <- data.frame(rbind(
    c(1.00, 1.25, 1.25, 1.25, 0, 0, 0, 0),
    c(1.00, 1.25, 1.25, 1.25, 0, 0, 0, 0),
    c(1.00, 1.25, 1.25, 1.25, 0, 0, 0, 0),
    c(1.00, 1.25, 1.25, 1.25, 0, 1, 0, 0),
    c(1.00, 1.25, 1.25, 1.25, 0, 1, 0, 0),
    c(1.00, 1.25, 1.25, 1.25, 0, 1, 0, 0),
    c(1.00, 1.25, 1.25, 1.25, 0, 1, 0, 0)
))

names(df) <- dfnames
names(dfc) <- dfnames

test_that("Scenario 2 is handled correctly", {
    expect_identical(csh_censor(df, csh = CSH, fuw = 1), dfc)
})

# Test Scenario 3.

df <- data.frame(rbind(
    c(1.25, 1.00, 1.75, 2.25, 0, 0, 0, 0),
    c(1.25, 1.00, 1.75, 2.25, 0, 0, 0, 1),
    c(1.25, 1.00, 1.75, 2.25, 0, 0, 1, 0),
    c(1.25, 1.00, 1.75, 2.25, 0, 0, 1, 1),
    c(1.25, 1.00, 1.75, 2.25, 1, 0, 0, 0),
    c(1.25, 1.00, 1.75, 2.25, 1, 0, 0, 1),
    c(1.25, 1.00, 1.75, 2.25, 1, 0, 1, 0),
    c(1.25, 1.00, 1.75, 2.25, 1, 0, 1, 1),
    c(1.25, 1.00, 1.75, 2.25, 0, 1, 0, 0),
    c(1.25, 1.00, 1.75, 2.25, 0, 1, 0, 1),
    c(1.25, 1.00, 1.75, 2.25, 0, 1, 1, 0),
    c(1.25, 1.00, 1.75, 2.25, 0, 1, 1, 1),
    c(1.25, 1.00, 1.75, 2.25, 1, 1, 0, 0),
    c(1.25, 1.00, 1.75, 2.25, 1, 1, 0, 1),
    c(1.25, 1.00, 1.75, 2.25, 1, 1, 1, 0),
    c(1.25, 1.00, 1.75, 2.25, 1, 1, 1, 1)
))

dfc <- data.frame(rbind(
    c(1.00, 1.00, 1.00, 1.00, 0, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 0, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 1, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 1, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 1, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 1, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 1, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 1, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 1, 0, 0),
    c(1.00, 1.00, 1.00, 1.00, 0, 1, 0, 0)
))

names(df) <- dfnames
names(dfc) <- dfnames

test_that("Scenario 3 is handled correctly", {
    expect_identical(csh_censor(df, csh = CSH, fuw = 1), dfc)
})

# Test Scenario 4.

df <- data.frame(rbind(
    c(1.00, 2.00, 2.25, 2.50, 0, 0, 0, 1),
    c(1.00, 2.00, 2.25, 2.50, 0, 0, 1, 0),
    c(1.00, 2.00, 2.25, 2.50, 0, 0, 1, 1),
    c(1.00, 2.00, 2.25, 2.50, 0, 1, 0, 0),
    c(1.00, 2.00, 2.25, 2.50, 0, 1, 0, 1),
    c(1.00, 2.00, 2.25, 2.50, 0, 1, 1, 0),
    c(1.00, 2.00, 2.25, 2.50, 0, 1, 1, 1)
))

dfc <- data.frame(rbind(
    c(1.00, 2.00, 2.00, 2.00, 0, 0, 0, 0),
    c(1.00, 2.00, 2.00, 2.00, 0, 0, 0, 0),
    c(1.00, 2.00, 2.00, 2.00, 0, 0, 0, 0),
    c(1.00, 2.00, 2.00, 2.00, 0, 1, 0, 0),
    c(1.00, 2.00, 2.00, 2.00, 0, 1, 0, 0),
    c(1.00, 2.00, 2.00, 2.00, 0, 1, 0, 0),
    c(1.00, 2.00, 2.00, 2.00, 0, 1, 0, 0)
))

names(df) <- dfnames
names(dfc) <- dfnames

test_that("Scenario 4 is handled correctly", {
    expect_identical(csh_censor(df, csh = CSH, fuw = 1), dfc)
})

# Test Scenario 5.

df <- data.frame(rbind(
    c(1.00, 2.00, 2.25, 2.50, 0, 0, 0, 0)
))

dfc <- data.frame(rbind(
    c(1.00, 2.00, 2.00, 2.00, 0, 0, 0, 0)
))

names(df) <- dfnames
names(dfc) <- dfnames

test_that("Scenario 5 is handled correctly", {
    expect_identical(csh_censor(df, csh = CSH, fuw = 1), dfc)
})

# Test Scenario 6.

df <- data.frame(rbind(
    c(1.00, 2.00, 2.25, 2.50, 0, 1, 0, 0),
    c(1.00, 2.00, 2.25, 2.50, 0, 1, 0, 0),
    c(1.00, 2.00, 2.25, 2.50, 0, 1, 1, 0),
    c(1.00, 2.00, 2.25, 2.50, 0, 1, 1, 1),
    c(1.00, 2.00, 2.25, 2.50, 0, 0, 1, 0)
))

dfc <- data.frame(rbind(
    c(1.00, 2.00, 2.00, 2.00, 0, 1, 0, 0),
    c(1.00, 2.00, 2.00, 2.00, 0, 1, 0, 0),
    c(1.00, 2.00, 2.00, 2.00, 0, 1, 0, 0),
    c(1.00, 2.00, 2.00, 2.00, 0, 1, 0, 0),
    c(1.00, 2.00, 2.00, 2.00, 0, 0, 0, 0)
))

names(df) <- dfnames
names(dfc) <- dfnames

test_that("Scenario 6 is handled correctly", {
    expect_identical(csh_censor(df, csh = CSH, fuw = 1), dfc)
})
